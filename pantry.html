<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	<script src="https://s3.amazonaws.com/stitch-sdks/js/bundles/4.0.0/stitch.js"></script>
    <!-- Bootstrap CSS -->
     
	<link href='https://fonts.googleapis.com/css?family=Quicksand' rel='stylesheet'>
	<link href='css/stylepantry.css' rel='stylesheet'>
	<!-- <link rel="stylesheet" href="css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"> -->
	<script>
		 // Initialize the App Client
      	const client = stitch.Stitch.initializeDefaultAppClient("onlinepantry-kyccp");
      // Get a MongoDB Service Client
      	const mongodb = client.getServiceClient(
			stitch.RemoteMongoClient.factory,
			"mongodb-atlas"
		  );
	  
		const db = mongodb.db("OnlinePantry");
		
		
		<!--function deleteComments(){ 
			<!--var coll = mongodb.db("OnlinePantry").collection("OnlinePantryContents");
			<!--coll.deleteMany({})
		<!--} 
		
		function displayComments() {
			db.collection("OnlinePantryContents").find({}).asArray()
			  .then(docs => docs.map(doc => ( "<div>" + doc.comment + "</div>")))
			  .then(OnlinePantryContentDivs => {
			      const contentElement = document.getElementById("OnlinePantryContents")
				  const contentHtml = OnlinePantryContentDivs.join("\n");
				  contentElement.innerHTML = contentHtml;
			  })
		}
      
	  
	  function displayCommentsOnLoad() {
        client.auth
          .loginWithCredential(new stitch.AnonymousCredential())
          .then(displayComments)
          .catch(console.error);
      }
	  
      // Get a reference to the blog database
      	
      	function addItem() {
        	const newItem = document.getElementById("new_item");
        	console.log("add item", client.auth.user.id);
        	console.log(newItem.value);
        	db.collection("OnlinePantryContents")
          	.insertOne({comment: newItem.value });
        	newItem.value = "";
      }
	  </script>
    <title>Pantry Content</title>
  </head>
  
  <body onload="displayCommentsOnLoad()">
	<div class="blurred-bg-container">
		<div class="content">
			<div class="text">
				<center><h1>Pantry Items</h1></center>
					 <hr>
						<div id="OnlinePantryContents"></div>
						<hr>
					</div> 
			</div>
			<div class="submitbtn">Add new Item: <input id="new_item"><input type="submit" onClick="addItem()" value="Add"></div>
			<a href="pantry.html" class="submitbtn">Check Pantry</a>
	</div>
		
  </body>
</html>
